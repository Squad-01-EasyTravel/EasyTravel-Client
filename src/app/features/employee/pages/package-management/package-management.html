<div class="d-flex">
  <app-sidebar></app-sidebar>
  <div class="package-management-container flex-grow-1">
    <div class="header">
      <h1>Gerenciamento de Pacotes</h1>
      <button class="btn-primary" (click)="openCreateModal()">
        <i class="icon-plus"></i>
        Novo Pacote
      </button>
    </div>

    <div class="packages-grid">
      <div class="package-card" *ngFor="let package of packages">
        <div class="package-image">
          <img [src]="package.imageUrl" [alt]="package.name" />
          <div class="package-status" [class.available]="package.available" [class.unavailable]="!package.available">
            {{ package.available ? 'Dispon√≠vel' : 'Indispon√≠vel' }}
          </div>
        </div>
        
        <div class="package-content">
          <h3>{{ package.name }}</h3>
          <p class="destination">{{ package.destination }}</p>
          <p class="description">{{ package.description }}</p>
          
          <div class="package-details">
            <div class="detail">
              <span class="label">Pre√ßo:</span>
              <span class="value">R$ {{ package.price | number:'1.2-2' }}</span>
            </div>
            <div class="detail">
              <span class="label">Dura√ß√£o:</span>
              <span class="value">{{ package.duration }} dias</span>
            </div>
            <div class="detail">
              <span class="label">Criado em:</span>
            <span class="value">{{ package.createdAt | date:'dd/MM/yyyy' }}</span>
          </div>
        </div>
      </div>
      
      <div class="package-actions">
        <button class="btn-secondary" (click)="openEditModal(package)">
          <i class="icon-edit"></i>
          Editar
        </button>
        <button 
          class="btn-toggle" 
          [class.btn-success]="!package.available"
          [class.btn-warning]="package.available"
          (click)="toggleAvailability(package)">
          {{ package.available ? 'Desativar' : 'Ativar' }}
        </button>
        <button class="btn-danger" (click)="deletePackage(package.id)">
          <i class="icon-delete"></i>
          Excluir
        </button>
      </div>
    </div>
  </div>

  <!-- Modal para Criar/Editar Pacote -->
  <div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ isEditMode ? 'Editar Pacote' : 'Novo Pacote' }}</h2>
        <button class="close-btn" (click)="closeModal()">√ó</button>
      </div>
      
      <form class="modal-body" (ngSubmit)="savePackage()">
        <div class="form-group">
          <label for="name">Nome do Pacote *</label>
          <input 
            type="text" 
            id="name" 
            [(ngModel)]="newPackage.name" 
            name="name"
            placeholder="Ex: Pacote Nordeste"
            required>
        </div>

        <div class="form-group">
          <label for="destination">Destino *</label>
          <input 
            type="text" 
            id="destination" 
            [(ngModel)]="newPackage.destination" 
            name="destination"
            placeholder="Ex: Fortaleza, CE"
            required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="price">Pre√ßo (R$) *</label>
            <input 
              type="number" 
              id="price" 
              [(ngModel)]="newPackage.price" 
              name="price"
              min="0"
              step="0.01"
              placeholder="0.00"
              required>
          </div>

          <div class="form-group">
            <label for="duration">Dura√ß√£o (dias) *</label>
            <input 
              type="number" 
              id="duration" 
              [(ngModel)]="newPackage.duration" 
              name="duration"
              min="1"
              placeholder="5"
              required>
          </div>
        </div>

        <div class="form-group">
          <label for="imageUrl">URL da Imagem</label>
          <input 
            type="url" 
            id="imageUrl" 
            [(ngModel)]="newPackage.imageUrl" 
            name="imageUrl"
            placeholder="https://exemplo.com/imagem.jpg">
        </div>

        <div class="form-group">
          <label for="description">Descri√ß√£o *</label>
          <textarea 
            id="description" 
            [(ngModel)]="newPackage.description" 
            name="description"
            rows="4"
            placeholder="Descreva o que o pacote inclui..."
            required></textarea>
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [(ngModel)]="newPackage.available" 
              name="available">
            <span class="checkmark"></span>
            Pacote dispon√≠vel para venda
          </label>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="closeModal()">
            Cancelar
          </button>
          <button 
            type="submit" 
            class="btn-primary" 
            [disabled]="!isFormValid()">
            {{ isEditMode ? 'Atualizar' : 'Criar' }} Pacote
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="packages.length === 0">
    <div class="empty-icon">üì¶</div>
    <h3>Nenhum pacote cadastrado</h3>
    <p>Comece criando seu primeiro pacote de viagem</p>
    <button class="btn-primary" (click)="openCreateModal()">
      Criar Primeiro Pacote
    </button>
  </div>
</div>
