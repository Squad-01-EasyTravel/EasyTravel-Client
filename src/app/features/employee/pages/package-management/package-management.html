<div class="d-flex">
  
  <div class="package-management-container flex-grow-1">
    <div class="header">
      <div>
        <h1>Gerenciamento de Pacotes</h1>
        <app-filter-search-package></app-filter-search-package>
      </div>
      
      <button class="btn-primary" (click)="openCreateModal()">
        <i class="icon-plus"></i>
        Novo Pacote
      </button>
    </div>

    <div class="packages-grid">
      <div class="package-card" *ngFor="let package of packages">
        <div class="package-image">
          <img [src]="package.imageUrl" [alt]="package.bundleTitle" />
          <div class="package-status" [class.available]="package.available" [class.unavailable]="!package.available">
            {{ package.available ? 'Dispon√≠vel' : 'Indispon√≠vel' }}
          </div>
        </div>
        
        <div class="package-content">
          <h3>{{ package.bundleTitle }}</h3>
          <p class="destination">{{ package.bundleRank }}</p>
          <p class="description">{{ package.bundleDescription }}</p>
          <div class="package-details">
            <div class="detail">
              <span class="label">Pre√ßo:</span>
              <span class="value">R$ {{ package.initialPrice | number:'1.2-2' }}</span>
            </div>
            <div class="detail">
              <span class="label">Data Inicial:</span>
              <span class="value">{{ package.initialDate | date:'dd/MM/yyyy HH:mm' }}</span>
            </div>
            <div class="detail">
              <span class="label">Data Final:</span>
              <span class="value">{{ package.finalDate | date:'dd/MM/yyyy HH:mm' }}</span>
            </div>
            <div class="detail">
              <span class="label">Quantidade:</span>
              <span class="value">{{ package.quantity }}</span>
            </div>
            <div class="detail">
              <span class="label">Viajantes:</span>
              <span class="value">{{ package.travelersNumber }}</span>
            </div>
            <div class="detail" *ngIf="package.videoUrl">
              <span class="label">V√≠deo:</span>
              <a [href]="package.videoUrl" target="_blank">Ver v√≠deo</a>
            </div>
            <div class="detail">
              <span class="label">Criado em:</span>
              <span class="value">{{ package.createdAt | date:'dd/MM/yyyy' }}</span>
            </div>
          </div>
          <div class="package-actions">
            <button class="btn-secondary" (click)="openEditModal(package)">
              <i class="icon-edit"></i>
              Editar
            </button>
            <button 
              class="btn-toggle" 
              [class.btn-success]="!package.available"
              [class.btn-warning]="package.available"
              (click)="toggleAvailability(package)">
              {{ package.available ? 'Desativar' : 'Ativar' }}
            </button>
            <button class="btn-danger" (click)="deletePackage(package.id)">
              <i class="icon-delete"></i>
              Excluir
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para Criar/Editar Pacote -->
  <div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ isEditMode ? 'Editar Pacote' : 'Novo Pacote' }}</h2>
        <button class="close-btn" (click)="closeModal()"></button>
      </div>
      
      <form class="modal-body" (ngSubmit)="savePackage()">
        <div class="form-group">
          <label for="bundleTitle">T√≠tulo do Pacote *</label>
          <input 
            type="text" 
            id="bundleTitle" 
            [(ngModel)]="newPackage.bundleTitle" 
            name="bundleTitle"
            placeholder="Ex: Pacote F√©rias Nordeste"
            required>
        </div>

        <div class="form-group">
          <label for="bundleDescription">Descri√ß√£o *</label>
          <textarea 
            id="bundleDescription" 
            [(ngModel)]="newPackage.bundleDescription" 
            name="bundleDescription"
            rows="4"
            placeholder="Descreva o que o pacote inclui..."
            required></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="initialPrice">Pre√ßo Inicial (R$) *</label>
            <input 
              type="number" 
              id="initialPrice" 
              [(ngModel)]="newPackage.initialPrice" 
              name="initialPrice"
              min="0"
              step="0.01"
              placeholder="1200.00"
              required>
          </div>

          <div class="form-group">
            <label for="bundleRank">Categoria *</label>
            <select 
              id="bundleRank" 
              [(ngModel)]="newPackage.bundleRank" 
              name="bundleRank"
              required>
            >
              <option value="">Selecione a categoria</option>
              <option value="BRONZE">Bronze</option>
              <option value="PRATA">Prata</option>
              <option value="OURO">Ouro</option>
              <option value="PLATINA">Platina</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="initialDate">Data Inicial *</label>
            <input 
              type="datetime-local" 
              id="initialDate" 
              [(ngModel)]="newPackage.initialDate" 
              name="initialDate"
              required>
          </div>

          <div class="form-group">
            <label for="finalDate">Data Final *</label>
            <input 
              type="datetime-local" 
              id="finalDate" 
              [(ngModel)]="newPackage.finalDate" 
              name="finalDate"
              required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="quantity">Quantidade Dispon√≠vel *</label>
            <input 
              type="number" 
              id="quantity" 
              [(ngModel)]="newPackage.quantity" 
              name="quantity"
              min="0"
              placeholder="10"
              required>
          </div>

          <div class="form-group">
            <label for="travelersNumber">N√∫mero de Viajantes *</label>
            <input 
              type="number" 
              id="travelersNumber" 
              [(ngModel)]="newPackage.travelersNumber" 
              name="travelersNumber"
              min="1"
              placeholder="2"
              required>
          </div>
        </div>

        <div class="form-group">
          <label for="imageUrl">URL da Imagem</label>
          <input 
            type="url" 
            id="imageUrl" 
            [(ngModel)]="newPackage.imageUrl" 
            name="imageUrl"
            placeholder="https://exemplo.com/imagem.jpg">
        </div>

        <div class="form-group">
          <label for="videoUrl">URL do V√≠deo</label>
          <input 
            type="url" 
            id="videoUrl" 
            [(ngModel)]="newPackage.videoUrl" 
            name="videoUrl"
            placeholder="https://exemplo.com/video.mp4">
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [(ngModel)]="newPackage.available" 
              name="available">
            <span class="checkmark"></span>
            Pacote dispon√≠vel para venda
          </label>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="closeModal()">
            Cancelar
          </button>
          <button 
            type="submit" 
            class="btn-primary" 
            [disabled]="!isFormValid()">
            {{ isEditMode ? 'Atualizar' : 'Criar' }} Pacote
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="packages.length === 0">
    <div class="empty-icon">üì¶</div>
    <h3>Nenhum pacote cadastrado</h3>
    <p>Comece criando seu primeiro pacote de viagem</p>
    <button class="btn-primary" (click)="openCreateModal()">
      Criar Primeiro Pacote
    </button>
  </div>
</div>
